{% extends 'textbook_exchange/account_base.html' %}
{% load static %} 

{% block inner-content %}
<style>
    .dashboard-div {
        background-color: #e5e5e5;
    }
</style>

{% if postSold %}
    <script>
    	alert("Successfully marked as sold.");
	</script>
{% endif %}
{% if status == "cashout_success" %}
	<script>
		alert('Successfully cashed out! Check the email used for this account for details.');
	</script>
{% endif %}

<!-- Name/Email/Header -->
    <div style="border: 2px solid black; padding: 10px 10px 10px 18px; margin-bottom: 25px;">
        <h1 style="margin-bottom: 10px;">{{ user.first_name }} {{ user.last_name }}</h1>
        <h5>{{ user.email }}</h5>
        <h5>Balance: ${{ user.balance }} <a href="{% url 'exchange:cashout' %}">Cashout</a></h5>
        <h5>Pending Balance: ${{ pending_balance }} <a href="{% url 'exchange:process' %}">Process (only exists for testing)</a></h5>
    </div>
	<br/><br/>
	
    <h1 class="custom-header">Current Posts</h1>

    <!-- POSTS -->
    <div class="row">
    {% for post in current_posts %}
        <div class="card text-font" style="width: 15rem;">
            <div class="card-header">
                <img class="card-img-top" src="{{ post.picture_url }}" alt="{{ post.textbook.title }}" style="margin-top: 10px;">
                <h5 class="card-title">{{ post.textbook.title }}</h5>
                <h6 class="card-subtitle mb-2 text-muted">{{ post.textbook.author_clean }}</h6> 
				<h5 class="card-subtitle mt-4 mb-2">${{ post.price }}</h5>
				<form method="GET">
					<a href="{% url 'exchange:edit_post' post.id post.textbook.title_clean %}" class="card-link">edit</a>
				</form>
            </div>
            <div class="card-body">
                <p class="card-subtitle mb-2 mb-4 text-muted" style="font-size: smaller;">Posted: {{ post.published_date }}</p>
                <p class="card-subtitle mb-4">
                    Condition:
                    {% if post.condition == "likenew" %}
                        Like new
                    {% elif post.condition == "verygood" %}
                        Very good
					          {% elif post.condition == "good" %}
				                Good
                    {% elif post.condition == "acceptable" %}
                        Acceptable
                    {% endif %}
                </p>
                <p class="card-text mb-4">{{ post.comments }}</p>
                <form action="" method="post">
                  {% csrf_token %}
                    <button href="#" name="sold_listing" value="{{ post.id }}" class="btn btn-primary mx-auto d-block" style="width: 40%;">
					  Sold?
					</button>
                  {% csrf_token %}     
                </form>
            </div>
        </div>
	{% endfor %}
</div>
  
<script>

$(document).ready(function() {
	function getCookie(name) {
		var value = "; " + document.cookie;
		var parts = value.split("; " + name + "=");
		if (parts.length == 2) 
			return parts.pop().split(";").shift();
	}
	
	if (getCookie("postUpdated")=="True") {
		alert("Post was successfully updated");
		document.cookie = "postUpdated=false";
	} 

    // $(".past-posts-div").hover(function() {
    //     console.log("hovering");
    //     $(".dashboard-div").css('background-color', '#f5f5f5');
    // });
    // $(".messages-div").hover(function() {
    //     console.log("hovering");
    //     $(".dashboard-div").css('background-color', '#f5f5f5');
    // });
    // $(".signout-div").hover(function() {
    //     console.log("hovering");
    //     $(".dashboard-div").css('background-color', '#f5f5f5');
    // });
    
    // $("#right").hover(function() {
    //     console.log("hovering");
    //     $(".dashboard-div").css('background-color', '#e5e5e5');
    // });
    // $("#left").hover(function() {
    //     console.log("hovering");
    //     $(".dashboard-div").css('background-color', '#e5e5e5');
    // });
});

</script>
{% endblock inner-content %}
